document.addEventListener("DOMContentLoaded",function(){function m(e){e.classList.remove("hidden"),e.classList.add("flex"),document.body.style.overflow="hidden"}function f(e){e.classList.add("hidden"),e.classList.remove("flex"),document.body.style.overflow=""}document.querySelectorAll("[data-modal-close]").forEach(e=>{e.addEventListener("click",function(){const t=this.closest(".modal");t&&f(t)})}),document.querySelectorAll(".modal-overlay").forEach(e=>{e.addEventListener("click",function(){const t=this.closest(".modal");t&&f(t)})}),document.addEventListener("keydown",function(e){e.key==="Escape"&&document.querySelectorAll(".modal:not(.hidden)").forEach(t=>{f(t)})}),document.querySelectorAll("[data-plan-subscribe]").forEach(e=>{e.addEventListener("click",function(){const t=this.getAttribute("data-plan-subscribe"),n=this.getAttribute("data-plan-name"),a=this.getAttribute("data-plan-price");if(typeof window.showConfirmDialog=="function"){const s=`「${n}」に加入しますか？

月額料金: ¥${a}

特典: 14日間の無料トライアル期間があります。
トライアル期間中はいつでもキャンセル可能です。`;window.showConfirmDialog(s,()=>{const c=document.createElement("form");c.method="POST",c.action="/subscriptions/checkout";const E=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");if(E){const u=document.createElement("input");u.type="hidden",u.name="_token",u.value=E,c.appendChild(u)}const d=document.createElement("input");d.type="hidden",d.name="plan",d.value=t,c.appendChild(d),document.body.appendChild(c),c.submit()})}})}),document.querySelectorAll("[data-cancel-subscription]").forEach(e=>{e.addEventListener("click",function(){typeof window.showConfirmDialog=="function"&&window.showConfirmDialog(`サブスクリプションをキャンセルしてもよろしいですか？

ご注意: キャンセル後も、現在の有効期限まで引き続きご利用いただけます。`,()=>{const n=document.createElement("form");n.method="POST",n.action="/subscriptions/cancel-subscription";const a=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");if(a){const s=document.createElement("input");s.type="hidden",s.name="_token",s.value=a,n.appendChild(s)}document.body.appendChild(n),n.submit()})})});const i=document.getElementById("enterprise-modal"),o=document.getElementById("additional_members"),p=document.getElementById("additional-price"),y=document.getElementById("total-price"),v=3e3,b=150;function l(){if(!o||!y||!p)return;const e=parseInt(o.value)||0,t=Math.max(0,Math.min(100,e));e!==t&&(o.value=t);const n=t*b,a=v+n;p.textContent=`¥${n.toLocaleString("ja-JP")}`,y.textContent=`¥${a.toLocaleString("ja-JP")}`}document.querySelectorAll('[data-plan="enterprise"]').forEach(e=>{e.addEventListener("click",function(){i&&(o&&(o.value="0"),l(),m(i))})}),document.querySelectorAll("[data-enterprise-subscribe]").forEach(e=>{e.addEventListener("click",function(){const t=this.getAttribute("data-plan-name");if(typeof window.showConfirmDialog=="function"){const n=`「${t}」に加入しますか？

基本料金: ¥3,000/月（10名まで）
追加メンバー: ¥150/月/名

特典: 14日間の無料トライアル期間があります。
トライアル期間中はいつでもキャンセル可能です。

次の画面で追加メンバー数を設定できます。`;window.showConfirmDialog(n,()=>{i&&(o&&(o.value="0"),l(),m(i))})}else i&&(o&&(o.value="0"),l(),m(i))})}),o&&(o.addEventListener("input",l),o.addEventListener("keypress",function(e){(e.key<"0"||e.key>"9")&&e.preventDefault()}),o.addEventListener("blur",function(){const e=parseInt(this.value)||0;e<0?this.value="0":e>100&&(this.value="100"),l()}));const r=document.querySelectorAll(".plan-card");r.forEach(e=>{e.addEventListener("mouseenter",function(){r.forEach(t=>{t!==e&&(t.style.transform="scale(0.97)",t.style.opacity="0.8")})}),e.addEventListener("mouseleave",function(){r.forEach(t=>{t.style.transform="",t.style.opacity=""})})});const g={threshold:.1,rootMargin:"0px 0px -100px 0px"},h=new IntersectionObserver(function(e){e.forEach((t,n)=>{t.isIntersecting&&(setTimeout(()=>{t.target.style.opacity="1",t.target.style.transform="translateY(0)"},n*100),h.unobserve(t.target))})},g);r.forEach(e=>{e.style.opacity="0",e.style.transform="translateY(30px)",e.style.transition="opacity 0.6s ease, transform 0.6s ease",h.observe(e)})});
