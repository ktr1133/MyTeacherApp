document.addEventListener("DOMContentLoaded",function(){function E(e){e.classList.remove("hidden"),e.classList.add("flex"),document.body.style.overflow="hidden"}function d(e){e.classList.add("hidden"),e.classList.remove("flex"),document.body.style.overflow=""}document.querySelectorAll("[data-modal-close]").forEach(e=>{e.addEventListener("click",function(){const t=this.closest(".modal");t&&d(t)})}),document.querySelectorAll(".modal-overlay").forEach(e=>{e.addEventListener("click",function(){const t=this.closest(".modal");t&&d(t)})}),document.addEventListener("keydown",function(e){e.key==="Escape"&&document.querySelectorAll(".modal:not(.hidden)").forEach(t=>{d(t)})}),document.querySelectorAll("[data-plan-subscribe]").forEach(e=>{e.addEventListener("click",function(){const t=this.getAttribute("data-plan-subscribe"),n=this.getAttribute("data-plan-name"),a=this.getAttribute("data-plan-price");if(typeof window.showConfirmDialog=="function"){const i=`「${n}」に加入しますか？

月額料金: ¥${a}

特典: 14日間の無料トライアル期間があります。
トライアル期間中はいつでもキャンセル可能です。`;window.showConfirmDialog(i,()=>{const c=document.createElement("form");c.method="POST",c.action="/subscriptions/checkout";const h=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");if(h){const r=document.createElement("input");r.type="hidden",r.name="_token",r.value=h,c.appendChild(r)}const l=document.createElement("input");l.type="hidden",l.name="plan",l.value=t,c.appendChild(l),document.body.appendChild(c),c.submit()})}})}),document.querySelectorAll("[data-cancel-subscription]").forEach(e=>{e.addEventListener("click",function(){typeof window.showConfirmDialog=="function"&&window.showConfirmDialog(`サブスクリプションをキャンセルしてもよろしいですか？

ご注意: キャンセル後も、現在の有効期限まで引き続きご利用いただけます。`,()=>{const n=document.createElement("form");n.method="POST",n.action="/subscriptions/cancel-subscription";const a=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");if(a){const i=document.createElement("input");i.type="hidden",i.name="_token",i.value=a,n.appendChild(i)}document.body.appendChild(n),n.submit()})})});const m=document.getElementById("enterprise-modal"),o=document.getElementById("additional_members"),f=document.getElementById("additional-price"),p=document.getElementById("total-price"),v=3e3,b=150;function u(){if(!o||!p||!f)return;const e=parseInt(o.value)||0,t=Math.max(0,Math.min(100,e));e!==t&&(o.value=t);const n=t*b,a=v+n;f.textContent=`¥${n.toLocaleString("ja-JP")}`,p.textContent=`¥${a.toLocaleString("ja-JP")}`}document.querySelectorAll('[data-plan="enterprise"]').forEach(e=>{e.addEventListener("click",function(){m&&(o&&(o.value="0"),u(),E(m))})}),o&&(o.addEventListener("input",u),o.addEventListener("keypress",function(e){(e.key<"0"||e.key>"9")&&e.preventDefault()}),o.addEventListener("blur",function(){const e=parseInt(this.value)||0;e<0?this.value="0":e>100&&(this.value="100"),u()}));const s=document.querySelectorAll(".plan-card");s.forEach(e=>{e.addEventListener("mouseenter",function(){s.forEach(t=>{t!==e&&(t.style.transform="scale(0.97)",t.style.opacity="0.8")})}),e.addEventListener("mouseleave",function(){s.forEach(t=>{t.style.transform="",t.style.opacity=""})})});const g={threshold:.1,rootMargin:"0px 0px -100px 0px"},y=new IntersectionObserver(function(e){e.forEach((t,n)=>{t.isIntersecting&&(setTimeout(()=>{t.target.style.opacity="1",t.target.style.transform="translateY(0)"},n*100),y.unobserve(t.target))})},g);s.forEach(e=>{e.style.opacity="0",e.style.transform="translateY(30px)",e.style.transition="opacity 0.6s ease, transform 0.6s ease",y.observe(e)})});
